---
layout: post
mathjax: true
description: ""
category: "è½¯ä»¶"
tags: ["docker", "ç”Ÿä¿¡"]
---

## multiqc pluginæ¨¡å—æ²¡æœ‰log
åŠ å…¥`log = logging.getLogger('multiqc')`
ä½†æ˜¯ä½¿ç”¨nextflow condaè¿è¡Œçš„.command.errä¸­ä¾ç„¶æ²¡æœ‰ã€‚
```
$ cat .command.err

  /// MultiQC ðŸ” | v1.21

|           multiqc | MultiQC Version v1.22.1 now available!
|           multiqc | Search path : /SGRNJ06/randd/USER/zhouyiqi/2024/scsnp/test/work/d4/e6e3e3522d59b05a7483001d66ae18
|         searching | â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 100% 43/43
|    custom_content | singleron-RD-scsnp-summary: Found 1 sample (html)
|    custom_content | singleron-RD-scsnp-methods-description: Found 1 sample (html)
|              star | Found 2 reports
|           multiqc | Report      : multiqc_report.html
|           multiqc | Data        : multiqc_data
|           multiqc | Plots       : multiqc_plots
|           multiqc | MultiQC complete
```
è§£å†³ï¼šåŠ å…¥`export PYTHONNOUSERSITE=0`åŽæœ‰äº†. `export PYTHONNOUSERSITE=0`å¯ä»¥å°†USER SITEåŠ å…¥sys.path,ä½†ä½¿ç”¨condaæ—¶ï¼Œå¦‚æžœUSER_SITEä¹Ÿå®‰è£…äº†multiqcï¼Œæœ‰å¯èƒ½ä¼šè¦†ç›–å¯¼è‡´é—®é¢˜ã€‚è¿˜æœ‰source codeä¸‹çš„buildä¹Ÿä¼šå¯¼è‡´é—®é¢˜ï¼Œä¾‹å¦‚`/SGRNJ06/randd/USER/zhouyiqi/2024/repo/scrna/multiqc_sgr/build`
```
sys.path = [
    '/SGRNJ06/randd/USER/zhouyiqi/2024/scrna/test/work/f8/1545255a0e84ce911eec348fe98fbd',
    '/SGRNJ06/randd/public/conda.cacheDir/multiqc-4f54eedb88586e68fa0d427fd44a5545/lib/python312.zip',
    '/SGRNJ06/randd/public/conda.cacheDir/multiqc-4f54eedb88586e68fa0d427fd44a5545/lib/python3.12',
    '/SGRNJ06/randd/public/conda.cacheDir/multiqc-4f54eedb88586e68fa0d427fd44a5545/lib/python3.12/lib-dynload',
    '/home/zhouyiqi/.local/lib/python3.12/site-packages',
    '/SGRNJ06/randd/public/conda.cacheDir/multiqc-4f54eedb88586e68fa0d427fd44a5545/lib/python3.12/site-packages',
]
USER_BASE: '/home/zhouyiqi/.local' (exists)
USER_SITE: '/home/zhouyiqi/.local/lib/python3.12/site-packages' (exists)
ENABLE_USER_SITE: True
```

```sh
    def is_docker = workflow.profile.tokenize(',').intersect(['docker', 'singularity']).size() >= 1
    def pipuser = is_docker ? '--user' : ''
    def pythonuser = is_docker ? 'export PYTHONNOUSERSITE=0' : ''
    """
    cp -r -L ./${multiqc_plugin} ./multiqc.plugin
    pip install ./multiqc.plugin --no-cache-dir $pipuser
    $pythonuser
```




